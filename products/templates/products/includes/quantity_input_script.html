<script>
    function handleEnableDisable(itemId) {
        const currentValue = parseInt($(`#id_qty_${itemId}`).val());
        $(`#decrement-qty_${itemId}`).prop("disabled", currentValue < 2);
        $(`#increment-qty_${itemId}`).prop("disabled", currentValue > 98);
    }

    // Set initial button state on page load
    $(".qty_input").each(function () {
        const itemId = $(this).data("item_id");
        handleEnableDisable(itemId);
    });

    // Increment quantity
    $(".increment-qty").click(function (e) {
        e.preventDefault();
        const closestInput = $(this).closest(".input-group").find(".qty_input");
        closestInput.val(parseInt(closestInput.val()) + 1);

        const itemId = $(this).data("item_id");
        handleEnableDisable(itemId);
    });

    // Decrement quantity
    $(".decrement-qty").click(function (e) {
        e.preventDefault();
        const closestInput = $(this).closest(".input-group").find(".qty_input");
        closestInput.val(parseInt(closestInput.val()) - 1);

        const itemId = $(this).data("item_id");
        handleEnableDisable(itemId);
    });

    // If user types/uses arrows, still enforce enable/disable logic
    $(".qty_input").change(function () {
        const itemId = $(this).data("item_id");
        handleEnableDisable(itemId);
    });
</script>
